{
    "name": "Common_Write_to_DB_Pipeline",
    "properties": {
        "description": "Simplified Shared Writing Station - Avoids ADF JSON parsing issues",
        "activities": [
            {
                "name": "Execute_Common_Write_to_DB_Notebook",
                "type": "DatabricksNotebook",
                "dependsOn": [],
                "policy": {
                    "timeout": "0.12:00:00",
                    "retry": 2,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [
                    {
                        "name": "NotebookPath",
                        "value": "/Shared/Common_Write_to_DB_Notebook"
                    },
                    {
                        "name": "Purpose", 
                        "value": "Simplified Sequential Database Writer"
                    }
                ],
                "typeProperties": {
                    "notebookPath": "/Shared/Common_Write_to_DB_Notebook",
                    "baseParameters": {
                        "input_survid": {
                            "value": "@pipeline().parameters.surveillanceRunIDInput",
                            "type": "Expression"
                        },
                        "input_ds_runid": {
                            "value": "@pipeline().parameters.datasetRunIDInput",
                            "type": "Expression"
                        },
                        "input_alert_type": {
                            "value": "@pipeline().parameters.alertTypeInput",
                            "type": "Expression"
                        }
                    },
                    "linkedServiceName": {
                        "referenceName": "ls_ccams_databricks",
                        "type": "LinkedServiceReference",
                        "parameters": {
                            "subscription_id": {
                                "value": "@pipeline().globalParameters.SubscriptionID",
                                "type": "Expression"
                            },
                            "databricks_url": {
                                "value": "@pipeline().globalParameters.ccamsDatabricksWS",
                                "type": "Expression"
                            },
                            "workspace_resource_id": {
                                "value": "@pipeline().globalParameters.ccamsDatabricksWSResouceID",
                                "type": "Expression"
                            },
                            "cluster_id": {
                                "value": "@pipeline().globalParameters.ClusterID",
                                "type": "Expression"
                            }
                        }
                    }
                }
            }
        ],
        "concurrency": 1,
        "parameters": {
            "surveillanceRunIDInput": {
                "type": "String",
                "defaultValue": "SIMPLIFIED_SURV_00000"
            },
            "datasetRunIDInput": {
                "type": "String",
                "defaultValue": "SIMPLIFIED_DS_00000"
            },
            "alertTypeInput": {
                "type": "String",
                "defaultValue": "Simplified Alert Type"
            }
        },
        "variables": {
            "varProcessingStatus": {
                "type": "String", 
                "defaultValue": "SIMPLIFIED_MODE"
            }
        },
        "folder": {
            "name": "SMBC_Database_Writers"
        },
        "annotations": [
            "Simplified Sequential Database Writer",
            "Concurrency Limited to 1", 
            "No JSON Parsing Issues",
            "Shared Writing Station",
            "Database Simulation Mode"
        ]
    }
}
