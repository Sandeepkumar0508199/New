try:
    json_data = json.loads(input_dataframe_json_str)
    alerts_df_spark = spark.createDataFrame(json_data, schema=alert_schema)
except json.JSONDecodeError:
    alerts_df_spark = spark.createDataFrame([], schema=alert_schema)
    print("Received invalid JSON for writing. No alerts to process.")



else:
        try:
            json_data = json.loads(input_dataframe_json_str)
            alerts_df_spark = spark.createDataFrame(json_data, schema=alert_schema)
        except json.JSONDecodeError:
            alerts_df_spark = spark.createDataFrame([], schema=alert_schema)
            print("Received invalid JSON for writing. No alerts to process.")

alert_schema = StructType([
        StructField("SMBCAIDPrefix", StringType(), True),
        StructField("ProductSymbol", StringType(), True),
        StructField("SMBCAlertTime", StringType(), True),
        StructField("SMBCLocalAlertTime", StringType(), True),
        StructField("SMBCAlertType", StringType(), True),
        StructField("IssuerName", StringType(), True),
        StructField("ShortAlertDescription", StringType(), True),
        StructField("TotalScore", StringType(), True),
        StructField("BusinessUnit", StringType(), True),
        StructField("SMBCAlertGenerationDate", StringType(), True),
        StructField("ProductName", StringType(), True),
        StructField("ProductID", StringType(), True),
        StructField("AccountID", StringType(), True),
        StructField("Exchange", StringType(), True),
        StructField("AssetClass", StringType(), True),
        StructField("LongDescription", StringType(), True),
        StructField("AnalyticsValue1", StringType(), True),
        StructField("AnalyticsValue2", StringType(), True),
        StructField("AnalyticsValue3", StringType(), True),
        StructField("AnalyticsValue4", StringType(), True),
        StructField("AnalyticsValue5", StringType(), True),
        StructField("AnalyticsValue6", StringType(), True),
        StructField("AnalyticsValue7", StringType(), True),
        StructField("AnalyticsValue8", StringType(), True),
        StructField("AnalyticsValue9", StringType(), True),
        StructField("AnalyticsValue10", StringType(), True),
        StructField("AnalyticsValue11", StringType(), True),
        StructField("AnalyticsValue12", StringType(), True),
        StructField("AnalyticsValue13", StringType(), True),
        StructField("AnalyticsValue14", StringType(), True),
        StructField("AnalyticsValue15", StringType(), True),
        StructField("AnalyticsValue16", StringType(), True),
        StructField("AnalyticsValue17", StringType(), True),
        StructField("AnalyticsValue18", StringType(), True),
        StructField("AnalyticsValue19", StringType(), True),
        StructField("AnalyticsValue20", StringType(), True),
        StructField("ThresholdValue1", StringType(), True),
        StructField("ThresholdValue2", StringType(), True),
        StructField("ThresholdValue3", StringType(), True),
        StructField("ThresholdValue4", StringType(), True),
        StructField("ThresholdValue5", StringType(), True),
        StructField("ThresholdValue6", StringType(), True),
        StructField("ThresholdValue7", StringType(), True),
        StructField("ThresholdValue8", StringType(), True),
        StructField("ThresholdValue9", StringType(), True),
        StructField("ThresholdValue10", StringType(), True),
        StructField("ThresholdValue11", StringType(), True),
        StructField("ThresholdValue12", StringType(), True),
        StructField("ThresholdValue13", StringType(), True),
        StructField("ThresholdValue14", StringType(), True),
        StructField("ThresholdValue15", StringType(), True),
        StructField("ThresholdValue16", StringType(), True),
        StructField("ThresholdValue17", StringType(), True),
        StructField("ThresholdValue18", StringType(), True),
        StructField("ThresholdValue19", StringType(), True),
        StructField("ThresholdValue20", StringType(), True),
        StructField("ScoreComponent1", StringType(), True),
        StructField("ScoreComponent2", StringType(), True),
        StructField("ScoreComponent3", StringType(), True),
        StructField("ScoreComponent4", StringType(), True),
        StructField("ScoreComponent5", StringType(), True),
        StructField("ScoreComponent6", StringType(), True),
        StructField("ScoreComponent7", StringType(), True),
        StructField("ScoreComponent8", StringType(), True),
        StructField("ScoreComponent9", StringType(), True),
        StructField("ScoreComponent10", StringType(), True),
        StructField("ScoreComponent11", StringType(), True),
        StructField("ScoreComponent12", StringType(), True),
        StructField("ScoreComponent13", StringType(), True),
        StructField("ScoreComponent14", StringType(), True),
        StructField("ScoreComponent15", StringType(), True),
        StructField("ScoreComponent16", StringType(), True),
        StructField("ScoreComponent17", StringType(), True),
        StructField("ScoreComponent18", StringType(), True),
        StructField("ScoreComponent19", StringType(), True),
        StructField("ScoreComponent20", StringType(), True),
        StructField("AlertRelatedListOrderClordIds", StringType(), True),
        StructField("AlertRelatedListExecutionClordIds", StringType(), True)
    ])
    
    if not input_dataframe_json_str or input_dataframe_json_str.strip() == '[]':
